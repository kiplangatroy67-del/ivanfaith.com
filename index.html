<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Romance for Ivan</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand&display=swap" rel="stylesheet">

<style>
body {
    margin:0;
    padding:30px;
    font-family:'Quicksand', sans-serif;
    text-align:center;
    transition: background 0.6s ease;
    background: linear-gradient(to bottom right,#ffe6ea,#fff);
    overflow-x:hidden;
}

h1 {
    font-family:'Pacifico', cursive;
    font-size:42px;
    color:#ff4d79;
}

h2 { color:#ff4d79; margin-top:30px; }

.mood-box {
    max-width:400px;
    margin:15px auto;
    padding:15px;
    border-radius:15px;
}

.mood-emoji { font-size:42px; }

input[type=range], input[type=file], input[type=text] { width:100%; max-width:400px; }

textarea {
    width:90%;
    max-width:400px;
    height:70px;
    padding:10px;
}

button {
    padding:10px 18px;
    border-radius:20px;
    border:none;
    background:#ff4d79;
    color:white;
    cursor:pointer;
    margin:5px 0;
}

.media {
    max-width:400px;
    margin:10px auto;
}

.media img, .media video {
    width:100%;
    border-radius:12px;
    margin-top:10px;
}

ul { list-style:none; padding:0; }

li {
    background: rgba(255,255,255,0.85);
    margin:8px auto;
    padding:10px;
    max-width:400px;
    border-radius:10px;
}

.sparkle {
    position: fixed;
    width: 6px;
    height: 6px;
    background: pink;
    border-radius: 50%;
    pointer-events: none;
    animation: fade 1s forwards;
}

@keyframes fade {
    to { opacity: 0; transform: scale(3); }
}

/* Chat styles */
#chatBox {
    max-width:400px;
    margin:10px auto;
    height:300px;
    overflow-y:auto;
    background:#fff8f8;
    padding:10px;
    border-radius:12px;
    border:1px solid #ffb3c6;
    text-align:left;
}

.chat-message {
    margin:5px 0;
}

.chat-message b {
    font-weight:bold;
}

.chat-message img, .chat-message video {
    max-width:80%;
    border-radius:10px;
}
</style>
</head>

<body>

<h1>‚ù§Ô∏è Romance for Ivan</h1>
<p>From Faith, with love</p>

<!-- Mood Tracer -->
<h2>üéµ Mood Tracer</h2>
<input type="range" min="0" max="4" value="2" oninput="updateMood(this.value)">
<div class="mood-box" id="moodBox">
    <div class="mood-emoji" id="moodEmoji">üòä</div>
    <p id="moodText">Soft & Happy</p>
</div>

<!-- Love Song -->
<h2>üéµ Our Love Song ‚Äî Unanifaa (Iyanii)</h2>
<button id="playSongBtn">Play Love Song ‚ù§Ô∏è</button>
<div style="max-width:400px;margin:0 auto;">
    <iframe 
        id="songPlayer"
        width="100%" 
        height="225"
        src="https://www.youtube.com/embed/eXdo_qXpbe4?enablejsapi=1"
        title="Unanifaa ‚Äî Iyanii"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
    </iframe>
</div>

<!-- Media Upload -->
<h2>üì∏ Upload Memories</h2>
<input type="file" accept="image/*,video/*" onchange="uploadMedia(this)">
<div id="mediaGallery"></div>

<!-- Text Memories -->
<h2>üí≠ Written Memories</h2>
<textarea id="memoryInput" placeholder="Write a sweet memory..."></textarea><br>
<button onclick="addMemory()">Save Memory</button>
<ul id="memoryList"></ul>

<!-- Chat Section -->
<h2>üíå Chat with Ivan</h2>
<div id="chatBox"></div>
<input type="text" id="chatInput" placeholder="Write a message..." style="width:70%;padding:8px;border-radius:12px;border:1px solid #ffb3c6;">
<input type="file" id="chatMedia" accept="image/*,video/*">
<button onclick="sendMessage()">Send ‚ù§Ô∏è</button>

<footer style="margin-top:40px;color:gray;">
Faith ‚ù§Ô∏è Ivan
</footer>

<!-- Firebase + App Scripts -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyB1xEg1rok7lTnuHUPbPM4j32Bgi78oYHU",
    authDomain: "faithivanchat.firebaseapp.com",
    projectId: "faithivanchat",
    storageBucket: "faithivanchat.firebasestorage.app",
    messagingSenderId: "760220492886",
    appId: "1:760220492886:web:bf4539aa10c2df0de747f7",
    measurementId: "G-340SKMRYB9"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getDatabase(app);
const messagesRef = ref(db, "messages");

/* Mood tracker, memories, media, hearts & music code here (same as before) */

/* Firebase chat */
const chatBox = document.getElementById("chatBox");
const chatInput = document.getElementById("chatInput");
const chatMedia = document.getElementById("chatMedia");

window.sendMessage = function() {
    const text = chatInput.value.trim();
    const file = chatMedia.files[0];

    if(!text && !file) return;

    if(file){
        const reader = new FileReader();
        reader.onload = () => {
            push(messagesRef, { text, media: reader.result, from: "Faith", time: new Date().toLocaleTimeString() });
        };
        reader.readAsDataURL(file);
    } else {
        push(messagesRef, { text, media: null, from: "Faith", time: new Date().toLocaleTimeString() });
    }

    chatInput.value = "";
    chatMedia.value = "";
};

onChildAdded(messagesRef, (snapshot)=>{
    const msg = snapshot.val();
    const div = document.createElement("div");
    div.className="chat-message";
    div.style.textAlign = msg.from==="Faith"?"right":"left";
    div.innerHTML = `<b>${msg.from}</b>: ${msg.text?msg.text:""} ${msg.media?msg.media.startsWith("data:image")?`<img src="${msg.media}">`:`<video src="${msg.media}" controls></video>`:""} <br><small>${msg.time}</small>`;
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
});
</script>

</body>
</html>
